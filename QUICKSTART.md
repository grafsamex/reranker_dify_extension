# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç - BGE Reranker Extension –¥–ª—è Dify

## üöÄ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (5 –º–∏–Ω—É—Ç)

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ Reranker API

```bash
# –í –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É
curl http://localhost:8009/health
```

### –®–∞–≥ 2: –£–ø–∞–∫—É–π—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ

```bash
cd rerank
python pack_extension.py
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª `bge-reranker-extension.difypkg`

### –®–∞–≥ 3: –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤ Dify

1. –û—Ç–∫—Ä–æ–π—Ç–µ Dify –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings ‚Üí Extensions** (–∏–ª–∏ **Plugins**)
3. –ù–∞–∂–º–∏—Ç–µ **"Install from Local Package"**
4. –ó–∞–≥—Ä—É–∑–∏—Ç–µ `bge-reranker-extension.difypkg`
5. –î–æ–∂–¥–∏—Ç–µ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (Dify —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–¥–µ–ª—å –≤ Dify

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings ‚Üí Model Providers** (–∏–ª–∏ **Models**)
2. –ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª **"Reranker"**
3. –í—ã–±–µ—Ä–∏—Ç–µ **"BGE Reranker"** –∏–ª–∏ **"BAAI/bge-reranker-v2-m3"**
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:
   - **API URL:** `http://your-server:8009`
   - **Timeout:** `30` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - **Top K:** `5` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –®–∞–≥ 5: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥–µ–ª—å

**–í Knowledge Base:**
1. –°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ Knowledge Base
2. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –≤—ã–±–µ—Ä–∏—Ç–µ **Reranker Model**
3. –í—ã–±–µ—Ä–∏—Ç–µ **"BAAI/bge-reranker-v2-m3"** –∏–∑ —Å–ø–∏—Å–∫–∞
4. –ú–æ–¥–µ–ª—å –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞

**–í Workflow:**
1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Workflow
2. –î–æ–±–∞–≤—å—Ç–µ —É–∑–µ–ª –ø–æ–∏—Å–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
3. –î–æ–±–∞–≤—å—Ç–µ —É–∑–µ–ª **"Reranker"**
4. –í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å **"BAAI/bge-reranker-v2-m3"** –∏–∑ —Å–ø–∏—Å–∫–∞
5. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –≤—ã—Ö–æ–¥ –ø–æ–∏—Å–∫–∞ –∫ Reranker
6. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã!

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ API
curl http://localhost:8009/health

# –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
curl -X POST http://localhost:8009/rerank \
  -H "Content-Type: application/json" \
  -d '{
    "query": "test",
    "passages": ["document 1", "document 2"],
    "top_k": 2
  }'
```

## üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —É–∫–∞–∂–∏—Ç–µ:

- **API URL:** `http://localhost:8009` (–∏–ª–∏ –≤–∞—à —Å–µ—Ä–≤–µ—Ä)
- **Timeout:** `30` —Å–µ–∫—É–Ω–¥
- **Top K:** `5` —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üÜò –ü—Ä–æ–±–ª–µ–º—ã?

1. **API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω?** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: `docker ps` –∏ `curl http://localhost:8009/health`
2. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è?** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `.difypkg` —Å–æ–∑–¥–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. **–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è?** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –∏ —Å–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `README.md`
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ: `INSTALL.md`
- –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: `example_usage.py`

