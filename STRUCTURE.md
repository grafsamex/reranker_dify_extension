# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è BGE Reranker –¥–ª—è Dify

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
rerank/
‚îú‚îÄ‚îÄ manifest.yaml          # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
‚îú‚îÄ‚îÄ icon.svg               # –ò–∫–æ–Ω–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
‚îú‚îÄ‚îÄ main.py                # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
‚îú‚îÄ‚îÄ __init__.py            # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è Python
‚îú‚îÄ‚îÄ requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
‚îú‚îÄ‚îÄ README.md              # –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ INSTALL.md             # –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
‚îú‚îÄ‚îÄ QUICKSTART.md          # –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
‚îú‚îÄ‚îÄ STRUCTURE.md           # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ pack_extension.py      # –°–∫—Ä–∏–ø—Ç –¥–ª—è —É–ø–∞–∫–æ–≤–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
‚îú‚îÄ‚îÄ example_usage.py       # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ .gitignore            # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã Git
```

## üìÑ –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã

#### `manifest.yaml`
–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ YAML:
- –ù–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ, –≤–µ—Ä—Å–∏—è
- –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (`entry_point`)
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–∏—Å—Ç–µ–º–µ
- –°—Å—ã–ª–∫–∞ –Ω–∞ –∏–∫–æ–Ω–∫—É —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

#### `icon.svg`
–ò–∫–æ–Ω–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ SVG:
- –í–µ–∫—Ç–æ—Ä–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Dify
- –†–∞–∑–º–µ—Ä 128x128 –ø–∏–∫—Å–µ–ª–µ–π
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏

#### `main.py`
–û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:
- –§—É–Ω–∫—Ü–∏—è `rerank()` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è Dify
- –ö–ª–∞—Å—Å `BGEReranker` - –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API
- –§—É–Ω–∫—Ü–∏—è `validate_config()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### `requirements.txt`
–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python:
- `requests>=2.31.0` - –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API

#### `__init__.py`
–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Python –º–æ–¥—É–ª—è:
- –≠–∫—Å–ø–æ—Ä—Ç –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –∫–ª–∞—Å—Å–æ–≤

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

#### `README.md`
–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:
- –û–ø–∏—Å–∞–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
- –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

#### `INSTALL.md`
–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ:
- –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ Reranker API
- –£–ø–∞–∫–æ–≤–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ Dify
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### `QUICKSTART.md`
–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –∑–∞ 5 –º–∏–Ω—É—Ç:
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —à–∞–≥–∏ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã

#### `pack_extension.py`
–°–∫—Ä–∏–ø—Ç –¥–ª—è —É–ø–∞–∫–æ–≤–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:
- –°–æ–∑–¥–∞–µ—Ç `.difypkg` —Ñ–∞–π–ª
- –í–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–æ–≤

#### `example_usage.py`
–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
- –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞ –Ω–∞–ø—Ä—è–º—É—é
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### `.gitignore`
–ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è Git:
- Python –∫—ç—à
- –£–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- IDE —Ñ–∞–π–ª—ã

## üîß –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –£–ø–∞–∫–æ–≤–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

```bash
cd rerank
python pack_extension.py
```

–°–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª `bge-reranker-extension.difypkg`

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ Dify

–ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Dify:
- Settings ‚Üí Extensions ‚Üí Install from Local Package
- –ó–∞–≥—Ä—É–∑–∏—Ç–µ `.difypkg` —Ñ–∞–π–ª

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —É–∫–∞–∂–∏—Ç–µ:
- `api_url`: URL –≤–∞—à–µ–≥–æ Reranker API
- `timeout`: –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
- `top_k`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

–ü–µ—Ä–µ–¥ —É–ø–∞–∫–æ–≤–∫–æ–π —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –Ω–∞ –º–µ—Å—Ç–µ:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
ls -la rerank/manifest.yaml
ls -la rerank/icon.svg
ls -la rerank/main.py
ls -la rerank/requirements.txt
ls -la rerank/__init__.py
```

## üì¶ –§–æ—Ä–º–∞—Ç –ø–∞–∫–µ—Ç–∞

–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —É–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç—Å—è –≤ ZIP –∞—Ä—Ö–∏–≤ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `.difypkg`:
- –í—Å–µ —Ñ–∞–π–ª—ã –≤ –∫–æ—Ä–Ω–µ –∞—Ä—Ö–∏–≤–∞
- –ë–µ–∑ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø–∞–ø–æ–∫
- UTF-8 –∫–æ–¥–∏—Ä–æ–≤–∫–∞ –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

1. **–†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ Reranker API** (—Å–º. –æ—Å–Ω–æ–≤–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é)
2. **–£–ø–∞–∫—É–π—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ** (`pack_extension.py`)
3. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤ Dify** (—á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** (URL API, timeout, top_k)
5. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ Workflow** (–¥–æ–±–∞–≤—å—Ç–µ —É–∑–µ–ª Reranker)

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ API
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç—è–∂–µ–ª—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (—Ç–æ–ª—å–∫–æ `requests`)
- –í—Å–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ Reranker API
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã

## üîó –°–≤—è–∑—å —Å –æ—Å–Ω–æ–≤–Ω—ã–º –ø—Ä–æ–µ–∫—Ç–æ–º

–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å Reranker API:
- API –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –æ—Ç–¥–µ–ª—å–Ω–æ
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ API —á–µ—Ä–µ–∑ HTTP
- API –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å –º–æ–¥–µ–ª—å—é

–°–º. –æ—Å–Ω–æ–≤–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è API.

